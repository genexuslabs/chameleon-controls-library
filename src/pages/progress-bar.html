<!DOCTYPE html>
<html dir="ltr" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0"
    />
    <title>ch-progress-bar</title>
    <script type="module" src="/build/chameleon.esm.js"></script>
    <script nomodule src="/build/chameleon.js"></script>
    <link href="/build/chameleon.css" rel="stylesheet" />
    <link rel="stylesheet" href="./assets/styles.css" />
  </head>
  <body>
    <div class="container">
      <h3>Custom Progress Bar</h3>
      <label for="timeout_i">Timeout</label><br>
      <input type="number" id="timeout_i" name="timeout_i" value="4000"><br><br>
      <button id="btn" onclick="updateProgressBar()">Update</button>
      <br><br>
      <ch-progress-bar></ch-progress-bar>
    </div>
    <script src="./assets/common.js"></script>
    <script>
      const barElement = document.querySelector('ch-progress-bar');
      const timeoutEl = document.getElementById("timeout_i");
      
      let timerId = null;
      let countdown = 0;

      function updateProgressBar() {
        document.querySelector('#btn').disabled = true;
        countdown = timeoutEl.value
        barElement.animationTime = timeoutEl.value
        barElement.presented = true
        timerId = setInterval(() => {
            if (countdown <= 0) {
              clearInterval(timerId);
              barElement.presented = false
              document.querySelector('#btn').disabled = false;
            } else {
              countdown -= 20;
              barElement.progress = (countdown * 100) / timeoutEl.value;
            }
          }, 20);
      };
    </script>
  </body>
</html>
